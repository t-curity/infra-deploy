# T-curity Infrastructure & Deployment

CI/CD íŒŒì´í”„ë¼ì¸ ë° ì¸í”„ë¼ ê´€ë¦¬ ì €ì¥ì†Œ

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Main Server (ì¼ë°˜ ì„œë²„)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Demo   â”‚ â”‚  SDK   â”‚ â”‚Backend â”‚ â”‚Redis â”‚ â”‚
â”‚  â”‚ :8080  â”‚ â”‚ :8081  â”‚ â”‚ :8000  â”‚ â”‚:6379 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ Private IP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           GPU Server (AI ì„œë²„)              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚   AI Server      â”‚               â”‚
â”‚         â”‚ PyTorch + CUDA   â”‚               â”‚
â”‚         â”‚     :9000        â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                  â”‚                         â”‚
â”‚         ~/tcurity-ai/models/               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ì„œë²„ ì •ë³´

| í™˜ê²½ | ì„œë²„ | Public IP | Private IP |
|------|------|-----------|------------|
| **AWS í…ŒìŠ¤íŠ¸** | Main | 43.201.104.130 | 10.0.3.61 |
| | GPU | 43.203.216.206 | 10.0.83.190 |
| **ì¹´ì¹´ì˜¤ í”„ë¡œë•ì…˜** | Main | 61.109.236.16 | 10.0.3.151 |
| | GPU | 61.109.238.4 | 10.0.83.48 |

## ğŸ“¦ ì„œë¹„ìŠ¤ í¬íŠ¸

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ì„œë²„ |
|--------|------|------|
| Demo Site | 8080 | Main |
| SDK | 8081 | Main |
| Backend API | 8000 | Main |
| Redis | 6379 | Main |
| AI Server | 9000 | GPU |

## ğŸš€ ë°°í¬ ë°©ë²•

### ìë™ ë°°í¬ (GitHub Actions)
ê° ë ˆí¬ì—ì„œ develop/dev ë¸Œëœì¹˜ì— push â†’ ìë™ ë¹Œë“œ & ë°°í¬

### ìˆ˜ë™ ë°°í¬
```bash
# ì „ì²´ ë°°í¬
./scripts/deploy.sh all

# ê°œë³„ ë°°í¬
./scripts/deploy.sh backend
./scripts/deploy.sh ai
./scripts/deploy.sh sdk
./scripts/deploy.sh demo
```

### GitHub Actions ìˆ˜ë™ ì‹¤í–‰
Actions â†’ Deploy Services â†’ Run workflow

## âš™ï¸ GitHub Secrets ì„¤ì •

Organization ë˜ëŠ” ê° ë ˆí¬ì— ì¶”ê°€:

| Secret | ì„¤ëª… |
|--------|------|
| `SSH_PRIVATE_KEY` | ì„œë²„ ì ‘ì†ìš© PEM í‚¤ ì „ì²´ |
| `SSH_USER` | `ubuntu` |
| `GHCR_TOKEN` | GitHub PAT (repo, packages ê¶Œí•œ) |

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
infra-deploy/
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ deploy.yml          # ë©”ì¸ ë°°í¬ ì›Œí¬í”Œë¡œìš°
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ docker-compose.main.yml
â”‚   â”œâ”€â”€ docker-compose.gpu.yml
â”‚   â””â”€â”€ nginx/default.conf
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup-main-server.sh
â”‚   â”œâ”€â”€ setup-gpu-server.sh
â”‚   â”œâ”€â”€ deploy.sh
â”‚   â””â”€â”€ status.sh
â””â”€â”€ docs/workflows/         # ê° ë ˆí¬ì— ë³µì‚¬í•  ì›Œí¬í”Œë¡œìš°
    â”œâ”€â”€ backend.yml
    â”œâ”€â”€ ai.yml
    â”œâ”€â”€ sdk.yml
    â””â”€â”€ demo.yml
```

## ğŸ› ï¸ ì´ˆê¸° ì„¤ì •

### 1. ì„œë²„ ì„¤ì •
```bash
# Main ì„œë²„
./scripts/setup-main-server.sh

# GPU ì„œë²„
./scripts/setup-gpu-server.sh
```

### 2. ê° ë ˆí¬ ì›Œí¬í”Œë¡œìš° ì ìš©
`docs/workflows/` í´ë”ì˜ íŒŒì¼ì„ ê° ë ˆí¬ì˜ `.github/workflows/`ì— ë³µì‚¬

### 3. GPU ì„œë²„ ëª¨ë¸ íŒŒì¼ ë°°ì¹˜
```
/home/ubuntu/tcurity-ai/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ phase_a/
â”‚   â”‚   â”œâ”€â”€ model_oneclass.pkl
â”‚   â”‚   â”œâ”€â”€ scaler_oneclass.pkl
â”‚   â”‚   â””â”€â”€ threshold_oneclass.json
â”‚   â””â”€â”€ phase_b/
â”‚       â””â”€â”€ best_model.pth
â””â”€â”€ data/
    â”œâ”€â”€ images/
    â””â”€â”€ processed_images/
```

## ğŸ“Š ìƒíƒœ í™•ì¸

```bash
./scripts/status.sh
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **Dockerfile ì´ë¦„**: SDK, Demo ë ˆí¬ì˜ `Dockefile` â†’ `Dockerfile`ë¡œ ìˆ˜ì • í•„ìš”
2. **Private IP í†µì‹ **: Backend â†’ AIëŠ” Private IP ì‚¬ìš©
3. **ëª¨ë¸ íŒŒì¼**: GPU ì„œë²„ì— ëª¨ë¸ íŒŒì¼ì´ ìˆì–´ì•¼ AI ì„œë²„ ì •ìƒ ë™ì‘
4. **GHCR ë¡œê·¸ì¸**: ê° ì„œë²„ì—ì„œ GHCR ë¡œê·¸ì¸ í•„ìš”

## ğŸ”’ HTTPS (ì˜ˆì •)

ë„ë©”ì¸ í™•ë³´ í›„:
1. Let's Encrypt ì¸ì¦ì„œ ë°œê¸‰
2. `docker/nginx/default.conf` ìˆ˜ì •
3. 443 í¬íŠ¸ ì—´ê¸°
